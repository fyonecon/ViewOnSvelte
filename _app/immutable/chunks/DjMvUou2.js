import{v as P,w as re,h as z,o as L,u as ie,g as ce,Z as x,T as le,U as de,V as Y,y as B,k as O,C as ge,aK as pe,aL as Z,L as ve,aM as I,P as G,R as he,a7 as _e,at as me,aN as X,aO as Ee,aP as ye,an as Se,aQ as Q,aR as xe,M as se,O as ae,aS as q,aT as Ce,N as Ne,l as be,E as we,aU as Re,aV as Te,ab as Me,F as ke,B as Ae,ad as Ie,ak as oe,ar as J,_ as ze,aW as ue,G as Fe,I as Ve}from"./tUfXnmxI.js";import{B as De}from"./9lQ3pMiW.js";import{m as Oe,i as $e,a as F,b as Pe,e as Le,M as V,t as Be,d as qe,w as j,I as H,g as He,h as Ue}from"./cesGV9A3.js";function ot(e,n){return n}function We(e,n,t){for(var i=[],p=n.length,u,c=n.length,f=0;f<p;f++){let d=n[f];ae(d,()=>{if(u){if(u.pending.delete(d),u.done.add(d),u.pending.size===0){var m=e.outrogroups;K(X(u.done)),m.delete(u),m.size===0&&(e.outrogroups=null)}}else c-=1},!1)}if(c===0){var g=i.length===0&&t!==null;if(g){var s=t,l=s.parentNode;Ce(l),l.append(s),e.items.clear()}K(n,!g)}else u={pending:new Set(n),done:new Set},(e.outrogroups??=new Set).add(u)}function K(e,n=!0){for(var t=0;t<e.length;t++)Ne(e[t],n)}var ee;function ut(e,n,t,i,p,u=null){var c=e,f=new Map;{var g=e;c=z?L(ie(g)):g.appendChild(P())}z&&ce();var s=null,l=_e(()=>{var h=t();return me(h)?h:h==null?[]:X(h)}),d,m=!0;function R(){_.fallback=s,Ge(_,d,c,n,i),s!==null&&(d.length===0?(s.f&I)===0?se(s):(s.f^=I,D(s,null,c)):ae(s,()=>{s=null}))}var o=re(()=>{d=x(l);var h=d.length;let w=!1;if(z){var C=le(c)===de;C!==(h===0)&&(c=Y(),L(c),B(!1),w=!0)}for(var T=new Set,N=ve,E=he(),S=0;S<h;S+=1){z&&O.nodeType===ge&&O.data===pe&&(c=O,w=!0,B(!1));var M=d[S],r=i(M,S),a=m?null:f.get(r);a?(a.v&&Z(a.v,M),a.i&&Z(a.i,S),E&&N.skipped_effects.delete(a.e)):(a=Je(f,m?c:ee??=P(),M,r,S,p,n,t),m||(a.e.f|=I),f.set(r,a)),T.add(r)}if(h===0&&u&&!s&&(m?s=G(()=>u(c)):(s=G(()=>u(ee??=P())),s.f|=I)),z&&h>0&&L(Y()),!m)if(E){for(const[y,v]of f)T.has(y)||N.skipped_effects.add(v.e);N.oncommit(R),N.ondiscard(()=>{})}else R();w&&B(!0),x(l)}),_={effect:o,items:f,outrogroups:null,fallback:s};m=!1,z&&(c=O)}function Ge(e,n,t,i,p){var u=n.length,c=e.items,f=e.effect.first,g,s=null,l=[],d=[],m,R,o,_;for(_=0;_<u;_+=1){if(m=n[_],R=p(m,_),o=c.get(R).e,e.outrogroups!==null)for(const r of e.outrogroups)r.pending.delete(o),r.done.delete(o);if((o.f&I)!==0)if(o.f^=I,o===f)D(o,null,t);else{var h=s?s.next:f;o===e.effect.last&&(e.effect.last=o.prev),o.prev&&(o.prev.next=o.next),o.next&&(o.next.prev=o.prev),A(e,s,o),A(e,o,h),D(o,h,t),s=o,l=[],d=[],f=s.next;continue}if((o.f&q)!==0&&se(o),o!==f){if(g!==void 0&&g.has(o)){if(l.length<d.length){var w=d[0],C;s=w.prev;var T=l[0],N=l[l.length-1];for(C=0;C<l.length;C+=1)D(l[C],w,t);for(C=0;C<d.length;C+=1)g.delete(d[C]);A(e,T.prev,N.next),A(e,s,T),A(e,N,w),f=w,s=N,_-=1,l=[],d=[]}else g.delete(o),D(o,f,t),A(e,o.prev,o.next),A(e,o,s===null?e.effect.first:s.next),A(e,s,o),s=o;continue}for(l=[],d=[];f!==null&&f!==o;)(g??=new Set).add(f),d.push(f),f=f.next;if(f===null)continue}(o.f&I)===0&&l.push(o),s=o,f=o.next}if(e.outrogroups!==null){for(const r of e.outrogroups)r.pending.size===0&&(K(X(r.done)),e.outrogroups?.delete(r));e.outrogroups.size===0&&(e.outrogroups=null)}if(f!==null||g!==void 0){var E=[];if(g!==void 0)for(o of g)(o.f&q)===0&&E.push(o);for(;f!==null;)(f.f&q)===0&&f!==e.fallback&&E.push(f),f=f.next;var S=E.length;if(S>0){var M=u===0?t:null;We(e,E,M)}}}function Je(e,n,t,i,p,u,c,f){var g=(c&Ee)!==0?(c&ye)===0?Se(t,!1,!1):Q(t):null,s=(c&xe)!==0?Q(p):null;return{v:g,i:s,e:G(()=>(u(n,g??t,s??p,f),()=>{e.delete(i)}))}}function D(e,n,t){if(e.nodes)for(var i=e.nodes.start,p=e.nodes.end,u=n&&(n.f&I)===0?n.nodes.start:t;i!==null;){var c=be(i);if(u.before(i),i===p)return;i=c}}function A(e,n,t){n===null?e.effect.first=t:n.next=t,t===null?e.effect.last=n:t.prev=n}function ft(e,n,...t){var i=new De(e);re(()=>{const p=n()??null;i.ensure(p,p&&(u=>p(u,...t)))},we)}function it(e){const n=Symbol();return{key:n,consume(){return Te(n)||e},provide(t){return Re(n,t)}}}function Ke(e){return new Proxy({},{get(n,t){return t==="style"?i=>e({style:i}).style:e}})}var ct=()=>e=>Array.from(new Set(e));const te={className:"class",defaultChecked:"checked",defaultValue:"value",htmlFor:"for",onBlur:"onfocusout",onChange:"oninput",onFocus:"onfocusin",onDoubleClick:"ondblclick"};function fe(e){let n="";for(let t in e){const i=e[t];i!=null&&(t.startsWith("--")||(t=t.replace(/[A-Z]/g,p=>`-${p.toLowerCase()}`)),n+=`${t}:${i};`)}return n}const Xe=new Set("viewBox,className,preserveAspectRatio,fillRule,clipPath,clipRule,strokeWidth,strokeLinecap,strokeLinejoin,strokeDasharray,strokeDashoffset,strokeMiterlimit".split(","));function Ye(e){return e in te?te[e]:Xe.has(e)?e:e.toLowerCase()}function Ze(e,n){return e==="style"&&typeof n=="object"?fe(n):n}const lt=Ke(e=>{const n={};for(const t in e)n[Ye(t)]=Ze(t,e[t]);return n}),Qe=/((?:--)?(?:\w+-?)+)\s*:\s*([^;]*)/g,je=e=>{const n={};let t;for(;t=Qe.exec(e);)n[t[1]]=t[2];return n};function dt(...e){const n=[];for(const i of e)i&&"class"in i&&i.class!=null&&n.push(i.class);const t=Oe(...e);return n.length>0&&(t.class=n.length===1?n[0]:n),"style"in t&&(typeof t.style=="string"&&(t.style=je(t.style)),t.style=fe(t.style)),t}function $(e){const n=e().defaultValue??e().value,t=e().isEqual??Object.is;let i=Me(ke(n));const p=J(()=>e().value!==void 0);let u={current:Ae(()=>x(i))},c={current:void 0};Ie(()=>{const s=x(p)?e().value:x(i);u={current:s},c={current:s}});const f=s=>{const l=F(s)?s(u.current):s,d=c.current;e().debug&&console.log(`[bindable > ${e().debug}] setValue`,{next:l,prev:d}),x(p)||ze(i,l,!0),t(l,d)||e().onChange?.(l,d)};function g(){return x(p)?e().value:x(i)}return{initial:n,ref:u,get:g,set(s){(e().sync?oe:$e)(()=>f(s))},invoke(s,l){e().onChange?.(s,l)},hash(s){return e().hash?.(s)??String(s)}}}$.cleanup=e=>{ue(()=>e())};$.ref=e=>{let n=e;return{get:()=>n,set:t=>{n=t}}};function et(e){const n={current:e};return{get(t){return n.current[t]},set(t,i){n.current[t]=i}}}const U=e=>typeof e=="function"?e():e,tt=(e,n)=>{let t=[],i=!0;Fe(()=>{if(i){t=e.map(u=>U(u)),i=!1;return}let p=!1;for(let u=0;u<e.length;u++)if(!Pe(t[u],U(e[u]))){p=!0;break}p&&(t=e.map(u=>U(u)),n())})};function W(e){return F(e)?e():e}function gt(e,n){const t=J(()=>{const{id:r,ids:a,getRootNode:y}=W(n);return He({id:r,ids:a,getRootNode:y})}),i=(...r)=>{e.debug&&console.log(...r)},p=J(()=>e.props?.({props:Ue(W(n)),scope:x(t)})??W(n)),u=nt(()=>x(p)),c=e.context?.({prop:u,bindable:$,get scope(){return x(t)},flush:ne,getContext(){return f},getComputed(){return N},getRefs(){return o},getEvent(){return m()}}),f={get(r){return c?.[r].get()},set(r,a){c?.[r].set(a)},initial(r){return c?.[r].initial},hash(r){const a=c?.[r].get();return c?.[r].hash(a)}};let g=new Map,s={current:null},l={current:null},d={current:{type:""}};const m=()=>({...d.current,current(){return d.current},previous(){return l.current}}),R=()=>({...E,hasTag(r){const a=E.get();return!!e.states[a]?.tags?.includes(r)},matches(...r){const a=E.get();return r.includes(a)}}),o=et(e.refs?.({prop:u,context:f})??{}),_=()=>({state:R(),context:f,event:m(),prop:u,send:M,action:h,guard:w,track:tt,refs:o,computed:N,flush:ne,scope:x(t),choose:T}),h=r=>{const a=F(r)?r(_()):r;if(!a)return;const y=a.map(v=>{const b=e.implementations?.actions?.[v];return b||j(`[zag-js] No implementation found for action "${JSON.stringify(v)}"`),b});for(const v of y)v?.(_())},w=r=>F(r)?r(_()):e.implementations?.guards?.[r](_()),C=r=>{const a=F(r)?r(_()):r;if(!a)return;const y=a.map(b=>{const k=e.implementations?.effects?.[b];return k||j(`[zag-js] No implementation found for effect "${JSON.stringify(b)}"`),k}),v=[];for(const b of y){const k=b?.(_());k&&v.push(k)}return()=>v.forEach(b=>b?.())},T=r=>Be(r).find(a=>{let y=!a.guard;return qe(a.guard)?y=!!w(a.guard):F(a.guard)&&(y=a.guard(_())),y}),N=r=>{Le(e.computed,()=>"[zag-js] No computed object found on machine");const a=e.computed[r];return a({context:f,event:m(),prop:u,refs:o,scope:x(t),computed:N})},E=$(()=>({defaultValue:e.initialState({prop:u}),onChange(r,a){a&&(g.get(a)?.(),g.delete(a)),a&&h(e.states[a]?.exit),h(s.current?.actions);const y=C(e.states[r]?.effects);if(y&&g.set(r,y),a===H){h(e.entry);const v=C(e.effects);v&&g.set(H,v)}h(e.states[r]?.entry)}}));let S=V.NotStarted;Ve(()=>{const r=S===V.Started;S=V.Started,i(r?"rehydrating...":"initializing..."),E.invoke(E.initial,H)}),ue(()=>{i("unmounting..."),S=V.Stopped,g.forEach(r=>r?.()),g=new Map,s.current=null,h(e.exit)});const M=r=>{if(S!==V.Started)return;l.current=d.current,d.current=r;let a=E.get();const y=e.states[a].on?.[r.type]??e.on?.[r.type],v=T(y);if(!v)return;s.current=v;const b=v.target??a;i("transition",r.type,v.target||a,`(${v.actions})`);const k=b!==a;k?E.set(b):v.reenter&&!k?E.invoke(a,a):h(v.actions)};return e.watch?.(_()),{get state(){return R()},send:M,context:f,prop:u,get scope(){return x(t)},refs:o,computed:N,get event(){return m()},getStatus:()=>S}}function nt(e){return function(t){return e()[t]}}function ne(e){oe(()=>{queueMicrotask(()=>e())})}export{ct as a,it as c,ut as e,ot as i,dt as m,lt as n,ft as s,gt as u};
