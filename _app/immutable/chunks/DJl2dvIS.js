const g=function(r,o={},l=20){let n=0,s="",c={};return new Promise(async p=>{const f=new AbortController,T=(l<=0?20:l)*1e3,u=setTimeout(()=>{f.abort(),console.warn(`FetchPOST请求超时: ${r}, 超时时间: ${l}秒`)},T);try{let t;typeof o=="string"||o instanceof FormData?t=o:t=JSON.stringify(o);const m={};o instanceof FormData||(m["Content-Type"]="application/json"),m.Accept="application/json, text/plain, */*";const e=await fetch(r,{method:"POST",headers:m,body:t,mode:"cors",cache:"no-cache",credentials:"omit",signal:f.signal});if(clearTimeout(u),!e.ok)console.warn("response.ok=",e,e.ok),n=0,s="POST Status Error.",c={api_url:r,status:e.status,statusText:e.statusText,error:"POST接口访问成功，但接口返回状态错误"},p({state:n,msg:s,content:c});else{const i=e.headers.get("content-type")||"";let a;try{i.includes("application/json")?a=await e.json():i.includes("text/")?a=await e.text():i.includes("form-data")?a=await e.formData():i.includes("image/")||i.includes("application/octet-stream")?a=await e.blob():a=await e.text()}catch(w){p({state:0,msg:"POST Parse Error.",content:{api_url:r,error:"响应解析失败",parseError:w.message}});return}p(a)}}catch(t){clearTimeout(u),t.name==="AbortError"?(n=404,s="POST Timeout.",c={api_url:r,error:`请求超时（${l}秒）`,error_type:"AbortError"}):(n=404,s="POST Broken.",c={api_url:r,error:t.message||"未知错误",error_type:t.name||"UnknownError"}),p({state:n,msg:s,content:c})}})};export{g as F};
